<!-- Custom Publications Layout -->
<div class="publications">
  {% assign publications = site.data.publications %}

  {% for pub in publications %}
    <div class="publication-item" data-aos="fade-up">
      <div class="row align-items-center mb-4">

        <!-- Publication Image -->
        <div class="col-md-3 col-sm-4 text-center">
          <div class="publication-image-container">
            <img src="{{ pub.image | relative_url }}"
                 alt="{{ pub.title }}"
                 class="publication-image img-fluid rounded shadow-sm"
                 data-bs-toggle="modal"
                 data-bs-target="#imageModal{{ forloop.index }}"
                 style="cursor: pointer; max-height: 150px; object-fit: cover;">
          </div>
        </div>

        <!-- Publication Details -->
        <div class="col-md-9 col-sm-8">
          <div class="publication-content">

            <!-- Title -->
            <h5 class="publication-title mb-2">{{ pub.title }}</h5>

            <!-- Authors -->
            <div class="publication-authors mb-2">
              {% assign equal_contrib_authors = "" %}
              {% for author in pub.authors %}
                {% if author.equal_contrib %}
                  {% assign equal_contrib_authors = equal_contrib_authors | append: author.name | append: ", " %}
                {% endif %}
              {% endfor %}

              {% for author in pub.authors %}
                {% if author.name %}
                  {% assign author_name = author.name %}
                {% else %}
                  {% assign author_name = author %}
                {% endif %}

                <span class="author {% if author_name == pub.highlight_author %}highlight-author{% endif %}">{{ author_name }}{% if author.equal_contrib %}<sup class="equal-contrib">*</sup>{% endif %}</span>{% unless forloop.last %}<span class="author-separator">, </span>{% endunless %}
              {% endfor %}

              {% if equal_contrib_authors != "" %}
                <div class="equal-contrib-note">
                  <small class="text-muted"><sup>*</sup> Equal contribution</small>
                </div>
              {% endif %}
            </div>

            <!-- Venue -->
            <div class="publication-venue mb-3">
              <em>{{ pub.venue }}</em>{% if pub.year %}<span class="publication-year">, {{ pub.year }}</span>{% endif %}
            </div>

            <!-- Action Buttons -->
            <div class="publication-buttons">
              {% if pub.paper %}
                <a href="{{ pub.paper }}" target="_blank" class="btn btn-sm btn-outline-primary publication-btn">
                  <i class="fas fa-file-pdf"></i> Paper
                </a>
              {% endif %}

              {% if pub.code %}
                <a href="{{ pub.code }}" target="_blank" class="btn btn-sm btn-outline-success publication-btn">
                  <i class="fab fa-github"></i> Code
                </a>
              {% endif %}

              {% if pub.dataset %}
                <a href="{{ pub.dataset }}" target="_blank" class="btn btn-sm btn-outline-info publication-btn">
                  <i class="fas fa-database"></i> Dataset
                </a>
              {% endif %}

              {% if pub.blog %}
                <a href="{{ pub.blog }}" target="_blank" class="btn btn-sm btn-outline-warning publication-btn">
                  <i class="fas fa-blog"></i> Blog
                </a>
              {% endif %}

              {% if pub.website %}
                <a href="{{ pub.website }}" target="_blank" class="btn btn-sm btn-outline-secondary publication-btn">
                  <i class="fas fa-globe"></i> Website
                </a>
              {% endif %}
            </div>

          </div>
        </div>
      </div>
    </div>

    <!-- Image Modal -->
    <div class="modal fade" id="imageModal{{ forloop.index }}" tabindex="-1" aria-labelledby="imageModalLabel{{ forloop.index }}" aria-hidden="true">
      <div class="modal-dialog modal-fullscreen-lg-down modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="imageModalLabel{{ forloop.index }}">{{ pub.title }}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body text-center">
            <img src="{{ pub.image | relative_url }}" alt="{{ pub.title }}" class="img-fluid">
          </div>
        </div>
      </div>
    </div>

    {% unless forloop.last %}<hr class="publication-divider">{% endunless %}
  {% endfor %}
</div>